<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-GB">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Why use this package • RtoSQLServer</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/Roboto-0.4.10/font.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Why use this package">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">RtoSQLServer</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">0.2.4</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../articles/RtoSQLServer.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/RtoSQLServer.html">Get started</a></li>
    <li><a class="dropdown-item" href="../articles/read_filter.html">Read table with column or row filtering</a></li>
    <li><a class="dropdown-item" href="../articles/load_method.html">Table loading method description</a></li>
    <li><a class="dropdown-item" href="../articles/why_use.html">Why use this package?</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/ScotGovAnalysis/RtoSQLServer/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Why use this package</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/ScotGovAnalysis/RtoSQLServer/blob/main/vignettes/why_use.Rmd" class="external-link"><code>vignettes/why_use.Rmd</code></a></small>
      <div class="d-none name"><code>why_use.Rmd</code></div>
    </div>

    
    
<p>The <code>RtoSQLServer</code> package relies on <a href="https://dbi.r-dbi.org/" class="external-link"><code>DBI</code></a> and <a href="https://github.com/r-dbi/odbc" class="external-link"><code>odbc</code></a> packages for
its database functionality, however you should consider using it instead
of <code>DBI</code> or <code>odbc</code> for the following reasons:</p>
<div class="section level2">
<h2 id="importing-large-dataframes">Importing large dataframes<a class="anchor" aria-label="anchor" href="#importing-large-dataframes"></a>
</h2>
<p>A key benefit of the package is to ensure the data loading process is
more robust than using <code>DBI</code> and <code>odbc</code> packages
alone.</p>
<p>When loading large dataframes from R into MS SQL Server using
<code>DBI</code> it was found that the loading process can hang and
never complete.</p>
<p>People using R to load data into SQL Server may be working at home
and have varying quality of connection to the database server.</p>
<p><code>RtoSQLServer</code> does two things to help with data
loading:</p>
<ol style="list-style-type: decimal">
<li><p>Loading the dataframe into a staging table in the database first
of all. When the load into the staging table is complete, the target
table is created as a copy of the staging table. This helps to prevent
misleading problems of incomplete loads. The staging table is dropped
once the target table has been created successfully.</p></li>
<li><p>Loading in batches. The <code>RtoSQLServer</code> package’s
<code>write_dataframe_to_db</code> function includes a
<code>batch_size</code> argument. Batch size is the number of rows of
the R dataframe that are loaded into the database staging table at once.
Using the batch loading process in <code>RtoSQLServer</code> it has been
possible to load large tables it was not possible to load in one using
<code>DBI</code>. The batch size is set for the user at a default of
100K so the user does not need to worry about a suitable batch size or
splitting up the source dataframe in R.</p></li>
</ol>
</div>
<div class="section level2">
<h2 id="self-contained-database-transactions">Self-contained database transactions<a class="anchor" aria-label="anchor" href="#self-contained-database-transactions"></a>
</h2>
<p>Unlike <code>DBI</code> and <code>odbc</code> where user must open a
database connection object in R and then pass this connection to
functions (before hopefully remembering to close it at the end of the R
session), in <code>RtoSQLServer</code> a database connection is
established when calling each function and closed at the end of that
function. This means there are not hung connections to the database,
waiting until the user closes R.</p>
<p>The <code>RtoSQLServer</code> functions can be used within user
custom functions as self-contained tasks and do not rely on an open
connection input argument. This also means a user does not need to know
how to setup a connection, they simply pass the server and database name
to the function. This can make it easier to run code others have
written.</p>
<p>Repeatedly opening and closing connections might make things slightly
slower, however it is thought this will not have much impact on the
workflow of the average R user where there will be only a few database
transactions in an R session.</p>
</div>
<div class="section level2">
<h2 id="checking-of-table-column-names-and-datatypes-from-r-to-sql-server">Checking of table, column names and datatypes from R to SQL
Server<a class="anchor" aria-label="anchor" href="#checking-of-table-column-names-and-datatypes-from-r-to-sql-server"></a>
</h2>
<p>The <code>DBI</code> and <code>odbc</code> packages are designed to
work with many different database engines. The <code>RtoSQLServer</code>
package has focused on Microsoft SQL Server. This allows checks to be
written to ensure the table name is compatible with SQL Server when
being read by an ODBC driver.</p>
<p>The package maps R dataframe datatypes to specific SQL Server
datatypes ensuring consistent, predictable data storage. The current max
length of string in an R character column vector is used to select the
size of the SQL Server <code>nvarchar()</code> database column.</p>
</div>
<div class="section level2">
<h2 id="extra-functionality-to-help-non-database-specialists">Extra functionality to help non-database specialists<a class="anchor" aria-label="anchor" href="#extra-functionality-to-help-non-database-specialists"></a>
</h2>
<p><code>RtoSQLServer</code> has functions to modify existing tables.
The <code><a href="../reference/drop_column.html">drop_column()</a></code>, <code><a href="../reference/rename_column.html">rename_column()</a></code>,
<code><a href="../reference/add_column.html">add_column()</a></code> column functions and the
<code><a href="../reference/rename_table.html">rename_table()</a></code> function do not have equivalents in DBI.
This saves users looking up SQL.</p>
<p>The <code><a href="../reference/db_table_metadata.html">db_table_metadata()</a></code> and
<code><a href="../reference/show_schema_tables.html">show_schema_tables()</a></code> functions provide an easy way to get
information about existing database objects. The
<code><a href="../reference/execute_sql.html">execute_sql()</a></code> function is an easy way to run custom SQL as
a closed transaction.</p>
</div>
<div class="section level2">
<h2 id="system-versioning">System Versioning<a class="anchor" aria-label="anchor" href="#system-versioning"></a>
</h2>
<p><code>RtoSQLServer</code> allows a user to create a table with MS SQL
Server <a href="https://docs.microsoft.com/en-us/sql/relational-databases/tables/creating-a-system-versioned-temporal-table?view=sql-server-ver15" class="external-link">System
Versioning</a> enabled. To do this using <code>RtoSQLServer</code> the
<code>write_dataframe_to_db</code> function is used with the
<code>versioned_table</code> argument set to TRUE.</p>
<p>System Versioning adds date / timestamp (SQL Server datatype
<code>DATETIME2</code>) start and end columns to the table. A
<code>&lt;table name&gt;History</code> table is created in the database
schema, storing the history of previous records following updates and
deletes. This allows users to maintain an archive of their table setup
in R, without needing to know the SQL used to establish System
Versioning as part of a <code>create table</code> SQL expression.</p>
<p>To drop a system versioned table using
<code>drop_table_from_db</code> requires extra privileges in the SQL
Server database. You may need to contact a system administrator to drop
these tables for you if you receive an error.</p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by the Scottish Government  <a href="mailto:statistics.enquiries@gov.scot"><i class="fas fa-envelope" aria-hidden="true"></i><span class="visually-hidden">Email Scottish Government&gt;</span></a>  <a href="https://github.com/scotgovanalysis" class="external-link"><i class="fab fa-github" aria-hidden="true"></i><span class="visually-hidden">Scottish Government GitHub profile&gt;</span></a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
